<!DOCTYPE html>

{% include head-tag.html %}
</head>
<body>
  <header id="main" class="homepage bigdata end-transition">
    {% include header.html %}
    <article class="bigdata">
      <h1>BIG DATA</h1>
      <h2>
      {% include_markdown homepage/impact_bigdata.md %}
      </h2>
    </article>
    <article class="mobile">
      <h1>MOBILE</h1>
      <h2>
      {% include_markdown homepage/impact_mobile.md %}
      </h2>
    </article>
    <article class="trustedapps">
      <h1>TRUSTED APPS</h1>
      <h2>
      {% include_markdown homepage/impact_trustedapps.md %}
      </h2>
    </article>
    <article class="joinus">
      <h1>JOIN US</h1>
      <h2>
      {% include_markdown homepage/impact_joinus.md %}
      </h2>
    </article>
    <figure class="bigdata"><div></div></figure>
    <figure class="mobile"><div></div></figure>
    <figure class="trustedapps"><div></div></figure>
    <figure class="joinus"><div></div></figure>
    <section class="article-links">
      <a class="bigdata" href="#">Big Data</a>
      <a class="mobile" href="#">Mobile</a>
      <a class="trustedapps" href="#">Trusted Apps</a>
      <a class="joinus" href="#">Join Us</a>
    </section>
    <ol class="nextprev">
      <li class="previous"><a href="#">&lt;</a></li>
      <li class="next"><a href="#">&gt;</a></li>
    </ol>
  </header>

  {{ content }}

  {% include footer.html %}
  <script>
    (function() {
      var classes = [ 'bigdata', 'mobile', 'trustedapps', 'joinus' ], 
          index = 0;

      // Move forward "1" or backward "-1" one place
      function move(direction) {
        var previousClass = classes[index % classes.length]
        index += direction
        // Wrap around if negative
        if (index < 0) index = classes.length - 1

        var newClass = classes[index % classes.length]

        if (direction > 0) {
          // CSS transition
          $('#main article').on('webkitTransitionEnd', function() {
            console.log('finished');
            $('#main').addClass('end-transition');
          });
          $('#main')[0].className = 'homepage ' + newClass + ' ' + previousClass + '_left';
        }
        else {
          $('#main')[0].className = 'homepage ' + newClass;
        }
      }
      // Show specific impact item
      function show(impactItem) {
        index = $.inArray(impactItem, classes);
        $('#main').removeClass(classes.join(' ')).addClass(impactItem)
      }
      var timer;
      // User events for changing impact item
      $('#main').on('click', '.article-links a, .nextprev a', function(e) {
        if (timer) clearInterval(timer);
        if ($.inArray(this.className, classes) >= 0) {
          show(this.className);
        } else {
          var className = $(this).parent()[0].className;
          if (className == 'next')
            move(1)
          else
            move(-1)
        }
        e.preventDefault();
      });

      // Cycle through the impact items
      function startSlideshow() {
        clearInterval(timer);
        timer = window.setInterval(function() {
          if (document.body.scrollTop < 200)
            move(1);
          }, {{ page.impact_duration_seconds }} * 1000);
      }
      $(window).on('blur', function() {
        clearInterval(timer);
      }).on('focus', function() {
        startSlideshow();
      });
      startSlideshow();

    })();
  </script>
</body>
</html>
